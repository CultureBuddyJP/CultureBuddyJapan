<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒãƒ‡ã‚£ãƒ¼ â€“ Culture Buddy</title>
  <meta name="description" content="ç¾¤é¦¬çœŒãƒ»æ ƒæœ¨çœŒãƒ»é•·é‡çœŒã®å¤šæ–‡åŒ–å…±ç”Ÿãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ " />
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { -webkit-font-smoothing: antialiased; }
    select { appearance: auto; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

/* â”€â”€â”€ tiny inline icons (replaces lucide) â”€â”€â”€ */
const Icon = ({ d, size = 16, cls = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={cls}>
    <path d={d} />
  </svg>
);
const Heart        = (p) => <Icon {...p} d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />;
const MessageCircle= (p) => <Icon {...p} d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />;
const Calendar     = (p) => <Icon {...p} d="M3 9h18M3 3h18v18H3zM16 3V1M8 3V1" />;
const MapPin       = (p) => <Icon {...p} d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0zM12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />;
const Users        = (p) => <Icon {...p} d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M9 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" />;
const Plus         = (p) => <Icon {...p} d="M12 5v14M5 12h14" />;
const ArrowRight   = (p) => <Icon {...p} d="M5 12h14M12 5l7 7-7 7" />;

/* â”€â”€â”€ i18n â”€â”€â”€ */
const i18n = {
  ja: {
    appName:"ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒãƒ‡ã‚£ãƒ¼", tagline:"ã¤ãªãŒã‚‹ã€å­¦ã¶ã€æ¥½ã—ã‚€",
    nav:{ home:"ãƒ›ãƒ¼ãƒ ", posts:"æŠ•ç¨¿", events:"ã‚¤ãƒ™ãƒ³ãƒˆ", profile:"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«" },
    home:{
      heading:"ã¿ã‚“ãªã§ã€ã¤ãªãŒã‚‹",
      sub:"ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒãƒ‡ã‚£ãƒ¼ã¯æ—¥æœ¬äººã‚‚å¤–å›½äººã‚‚ç§»ä½è€…ã‚‚ã€åœ°åŸŸã§åŠ©ã‘åˆã„å­¦ã³åˆã†ãŸã‚ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ã¾ãšã€ã‚ãªãŸã®åœ°åŸŸã‚’é¸ã‚“ã§ãã ã•ã„ã€‚",
      cta:"å§‹ã‚ã‚‹",
      cards:[
        { icon:"ğŸ¤", title:"ã‚¹ã‚­ãƒ«äº¤æ›",   desc:"æ–™ç†ãƒ»è¨€èªãƒ»æ–‡åŒ–ã‚’æ•™ãˆåˆã†" },
        { icon:"ğŸ’¬", title:"ç”Ÿæ´»ã‚µãƒãƒ¼ãƒˆ", desc:"æ—¥å¸¸ã®å›°ã‚Šã”ã¨ã‚’åŠ©ã‘åˆã†" },
        { icon:"ğŸ‰", title:"ã‚¤ãƒ™ãƒ³ãƒˆ",     desc:"äº¤æµã‚¤ãƒ™ãƒ³ãƒˆã§å‹é”ã‚’ä½œã‚‹" },
      ],
      stats:[{ num:"500+", label:"ãƒ¦ãƒ¼ã‚¶ãƒ¼" },{ num:"120+", label:"ã‚¤ãƒ™ãƒ³ãƒˆ" },{ num:"800+", label:"ã¤ãªãŒã‚Š" }],
    },
    posts:{
      heading:"ã¿ã‚“ãªã®æŠ•ç¨¿", newPost:"æ–°è¦æŠ•ç¨¿", skillShare:"ã‚¹ã‚­ãƒ«ã‚·ã‚§ã‚¢", helpNeeded:"åŠ©ã‘ã¦ã»ã—ã„", sendMsg:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹",
      form:{ type:"ã‚¿ã‚¤ãƒ—", title:"ã‚¿ã‚¤ãƒˆãƒ«", desc:"èª¬æ˜", offerSkill:"ã‚¹ã‚­ãƒ«ã‚’æ•™ãˆã‚‹", needHelp:"ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦", submit:"æŠ•ç¨¿ã™ã‚‹", region:"åœ°åŸŸ" },
    },
    events:{ heading:"ä»Šå¾Œã®ã‚¤ãƒ™ãƒ³ãƒˆ", createEvent:"ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½œã‚‹", join:"å‚åŠ ã™ã‚‹", participants:"å‚åŠ è€…" },
    profile:{
      heading:"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä½œæˆ", yourType:"ã‚ãªãŸã¯ï¼Ÿ", local:"åœ°å…ƒã®äºº", foreigner:"å¤–å›½äºº", migrant:"ç§»ä½è€…",
      name:"åå‰", interests:"èˆˆå‘³ãƒ»é–¢å¿ƒ", canTeach:"æ•™ãˆã‚‰ã‚Œã‚‹ã“ã¨", needHelp:"æ‰‹ä¼ã£ã¦ã»ã—ã„ã“ã¨",
      region:"ãŠä½ã¾ã„ã®çœŒ", save:"ä¿å­˜", placeholder:"æ–™ç†ã€ãƒã‚¤ã‚­ãƒ³ã‚°ã€å†™çœŸâ€¦",
    },
    msgSent:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚Šã¾ã—ãŸï¼", saved:"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼", all:"å…¨åœ°åŸŸ",
  },
  en: {
    appName:"Culture Buddy", tagline:"Connect, Learn, Enjoy",
    nav:{ home:"Home", posts:"Posts", events:"Events", profile:"Profile" },
    home:{
      heading:"Connect together",
      sub:"Culture Buddy is a platform for locals, foreigners, and migrants to help and learn from each other. Choose your region to get started.",
      cta:"Get Started",
      cards:[
        { icon:"ğŸ¤", title:"Skill Exchange", desc:"Share cooking, language & culture" },
        { icon:"ğŸ’¬", title:"Life Support",   desc:"Help each other with daily life" },
        { icon:"ğŸ‰", title:"Events",         desc:"Make friends at community events" },
      ],
      stats:[{ num:"500+", label:"Users" },{ num:"120+", label:"Events" },{ num:"800+", label:"Connections" }],
    },
    posts:{
      heading:"Community Posts", newPost:"New Post", skillShare:"Skill Share", helpNeeded:"Help Needed", sendMsg:"Send Message",
      form:{ type:"Type", title:"Title", desc:"Description", offerSkill:"Offer a Skill", needHelp:"Need Support", submit:"Post", region:"Region" },
    },
    events:{ heading:"Upcoming Events", createEvent:"Create Event", join:"Join", participants:"Participants" },
    profile:{
      heading:"Create Profile", yourType:"You are a:", local:"Local Resident", foreigner:"Foreigner", migrant:"Migrant",
      name:"Name", interests:"Interests", canTeach:"Can Teach", needHelp:"Need Help With",
      region:"Your Prefecture", save:"Save", placeholder:"Cooking, hiking, photographyâ€¦",
    },
    msgSent:"Message sent!", saved:"Profile saved!", all:"All Regions",
  },
};

/* â”€â”€â”€ data â”€â”€â”€ */
const regions = [
  { key:"gunma",   ja:"ç¾¤é¦¬çœŒ", en:"Gunma"   },
  { key:"tochigi", ja:"æ ƒæœ¨çœŒ", en:"Tochigi" },
  { key:"nagano",  ja:"é•·é‡çœŒ", en:"Nagano"  },
];

const initialPosts = [
  { id:1, type:"skill", author:"ç”°ä¸­ã•ã‚“", region:"gunma",
    title:{ ja:"æ—¥æœ¬èªã‚’æ•™ãˆã¾ã™", en:"I can teach Japanese" },
    desc:{ ja:"æ—¥å¸¸ä¼šè©±ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼é€±æœ«ãªã‚‰æ™‚é–“ãŒã‚ã‚Šã¾ã™ã€‚", en:"Let's start with daily conversation! Free on weekends." }, likes:12 },
  { id:2, type:"help", author:"Maria", region:"gunma",
    title:{ ja:"å½¹æ‰€ã®æ›¸é¡ã‚’æ‰‹ä¼ã£ã¦ã»ã—ã„", en:"Need help with government forms" },
    desc:{ ja:"ä½æ°‘ç¥¨ã®æ‰‹ç¶šããŒé›£ã—ã„ã§ã™ã€‚ä¸€ç·’ã«è¡Œã£ã¦ãã‚Œã‚‹æ–¹ã„ã¾ã›ã‚“ã‹ï¼Ÿ", en:"Resident registration is tricky. Can someone come with me?" }, likes:8 },
  { id:3, type:"skill", author:"John", region:"tochigi",
    title:{ ja:"è‹±ä¼šè©±ãƒ¬ãƒƒã‚¹ãƒ³", en:"English Conversation Lessons" },
    desc:{ ja:"ãƒã‚¤ãƒ†ã‚£ãƒ–ã®è‹±èªã‚’æ•™ãˆã¾ã™ã€‚ã‚«ãƒ•ã‚§ã§æ°—è»½ã«è©±ã—ã¾ã—ã‚‡ã†ï¼", en:"Native English lessons. Let's chat casually at a cafe!" }, likes:15 },
  { id:4, type:"skill", author:"ä½è—¤ã•ã‚“", region:"tochigi",
    title:{ ja:"æ—¥æœ¬ã®æ–™ç†ã‚’æ•™ãˆã¾ã™", en:"Japanese Cooking Class" },
    desc:{ ja:"ã¿ãæ±½ã‚„ãŠã«ãã‚Šã®ä½œã‚Šæ–¹ã‚’æ•™ãˆã¾ã™ã€‚æ¥½ã—ãå­¦ã³ã¾ã—ã‚‡ã†ï¼", en:"Learn miso soup & onigiri! Fun and easy." }, likes:20 },
  { id:5, type:"help", author:"Ana", region:"nagano",
    title:{ ja:"ã‚¹ãƒ¼ãƒ‘ãƒ¼ã§é£Ÿæã‚’è²·ã†ã®ãŒå¤§å¤‰", en:"Grocery shopping is tough" },
    desc:{ ja:"æ—¥æœ¬èªã®ãƒ©ãƒ™ãƒ«ãŒèª­ã‚ãªã„ã®ã§ã€ä¸€ç·’ã«è¡Œã£ã¦ãã‚Œã‚‹æ–¹ãŒã„ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚", en:"Can't read Japanese labels. Would love someone to come along!" }, likes:6 },
  { id:6, type:"skill", author:"å¤ªç”°ã•ã‚“", region:"nagano",
    title:{ ja:"ã‚¹ã‚­ãƒ¼ã‚’æ•™ãˆã¾ã™ï¼", en:"Ski Lessons Available!" },
    desc:{ ja:"é•·é‡ã®ã‚²ãƒ¬ãƒ³ãƒ‡ã§æ¥½ã—ã„æ™‚é–“ã‚’éã”ã—ã¾ã—ã‚‡ã†ã€‚åˆå¿ƒè€…æ­“è¿ï¼", en:"Let's enjoy Nagano's slopes! Beginners welcome." }, likes:30 },
];

const initialEvents = [
  { id:1, region:"gunma",
    title:{ ja:"å¤šæ–‡åŒ–æ–™ç†äº¤æµä¼š", en:"Multicultural Cooking Exchange" }, date:"2026-02-15",
    location:{ ja:"ä¸­ä¹‹æ¡ç”ºå…¬æ°‘é¤¨", en:"Nakanojo Community Center" },
    desc:{ ja:"ã¿ã‚“ãªã§æ¯å›½ã®æ–™ç†ã‚’ä½œã£ã¦é£Ÿã¹ã‚ˆã†ï¼", en:"Cook and enjoy food from our home countries!" }, participants:8 },
  { id:2, region:"gunma",
    title:{ ja:"è‰æ´¥æ¸©æ³‰ãƒã‚¤ã‚­ãƒ³ã‚°", en:"Kusatsu Hot Spring Hike" }, date:"2026-02-22",
    location:{ ja:"è‰æ´¥æ¸©æ³‰å‘¨è¾º", en:"Around Kusatsu Onsen" },
    desc:{ ja:"åœ°å…ƒã¨ä¸€ç·’ã«è‡ªç„¶ã‚’æ¥½ã—ã‚‚ã†ï¼æ¸©æ³‰ä»˜ãã€‚", en:"Enjoy nature with locals! Hot spring included." }, participants:12 },
  { id:3, region:"tochigi",
    title:{ ja:"æ—¥å…‰æ–‡åŒ–ä½“é¨“ã‚¤ãƒ™ãƒ³ãƒˆ", en:"Nikko Culture Experience" }, date:"2026-03-01",
    location:{ ja:"æ—¥å…‰å¸‚æ–‡åŒ–ã‚»ãƒ³ã‚¿ãƒ¼", en:"Nikko Cultural Center" },
    desc:{ ja:"æ—¥å…‰ã®æ–‡åŒ–ã‚„æ­´å²ã‚’æ¥½ã—ã¿ãªãŒã‚‰äº¤æµã—ã‚ˆã†ï¼", en:"Learn about Nikko's culture & history together!" }, participants:15 },
  { id:4, region:"tochigi",
    title:{ ja:"æ ƒæœ¨èªå­¦äº¤æµä¼š", en:"Tochigi Language Exchange" }, date:"2026-03-08",
    location:{ ja:"å®‡éƒ½å®®å¸‚å›½éš›äº¤æµã‚»ãƒ³ã‚¿ãƒ¼", en:"Utsunomiya Int'l Exchange Center" },
    desc:{ ja:"è‹±èªãƒ»æ—¥æœ¬èªã®è¨€èªäº¤æ›ã€‚æ°—è»½ã«å‚åŠ ã©ã†ãï¼", en:"English & Japanese language swap. Feel free to join!" }, participants:10 },
  { id:5, region:"nagano",
    title:{ ja:"é•·é‡ã‚¹ã‚­ãƒ¼ãƒ„ã‚¢ãƒ¼", en:"Nagano Ski Tour" }, date:"2026-02-28",
    location:{ ja:"é•·é‡å¸‚ã‚¹ã‚­ãƒ¼å ´", en:"Nagano Ski Resort" },
    desc:{ ja:"ã¿ã‚“ãªã§é›ªã®ä¸Šã§æ¥½ã—ã‚‚ã†ï¼åˆå¿ƒè€…ã‚‚å¤§ä¸ˆå¤«ã€‚", en:"Fun in the snow for everyone! Beginners welcome." }, participants:20 },
  { id:6, region:"nagano",
    title:{ ja:"ä¿¡å·ã®å‘³ é£Ÿå±•", en:"Shinshu Food Festival" }, date:"2026-03-05",
    location:{ ja:"é•·é‡å¸‚ä¸­å¤®å…¬åœ’", en:"Nagano Central Park" },
    desc:{ ja:"ä¿¡å·ã®ç¾å‘³ã—ã„é£Ÿã¹ç‰©ã‚’æ¥½ã—ã¿ãªãŒã‚‰äº¤æµã—ã‚ˆã†ï¼", en:"Enjoy Shinshu food & make friends!" }, participants:25 },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function App() {
  const [lang, setLang]               = useState("ja");
  const [view, setView]               = useState("home");
  const [posts, setPosts]             = useState(initialPosts);
  const [profile, setProfile]         = useState(null);
  const [filterRegion, setFilterRegion] = useState("all");
  const t = i18n[lang];
  const regionLabel = (key) => (regions.find(r => r.key === key) || {})[lang] || key;

  /* â”€â”€ filter bar (shared) â”€â”€ */
  const FilterBar = () => (
    <div className="flex gap-2 mb-6 flex-wrap">
      {[{ key:"all", label: t.all }, ...regions.map(r => ({ key: r.key, label: r[lang] }))].map(item => (
        <button key={item.key} onClick={() => setFilterRegion(item.key)}
          className={`px-3 py-1.5 rounded-lg text-sm font-medium border transition-colors ${filterRegion === item.key ? "bg-gray-900 text-white border-gray-900" : "border-gray-300 text-gray-600 hover:border-gray-400"}`}
        >{item.label}</button>
      ))}
    </div>
  );

  /* â”€â”€â”€ HOME â”€â”€â”€ */
  const Home = () => (
    <div className="max-w-4xl mx-auto pt-16 pb-24 px-4">
      <h1 className="text-5xl font-bold text-gray-900 tracking-tight mb-4">{t.home.heading}</h1>
      <p className="text-lg text-gray-500 max-w-xl mb-8 leading-relaxed">{t.home.sub}</p>

      <div className="flex gap-3 flex-wrap mb-10">
        {regions.map(r => (
          <button key={r.key}
            onClick={() => { setProfile(p => ({ ...(p||{}), region: r.key })); setFilterRegion(r.key); setView("profile"); }}
            className="inline-flex items-center gap-2 border border-gray-300 rounded-lg px-4 py-2.5 text-sm font-medium text-gray-700 hover:border-gray-500 hover:bg-gray-50 transition-colors"
          >
            <span className="w-2 h-2 rounded-full bg-gray-900 inline-block" />
            {r[lang]}
            <ArrowRight size={16} cls="text-gray-400" />
          </button>
        ))}
      </div>

      <div className="grid sm:grid-cols-3 gap-4 mt-12">
        {t.home.cards.map((c, i) => (
          <div key={i} className="bg-white border border-gray-200 rounded-xl p-6 hover:border-gray-400 transition-colors">
            <span className="text-3xl">{c.icon}</span>
            <h3 className="mt-3 text-lg font-semibold text-gray-900">{c.title}</h3>
            <p className="text-sm text-gray-500 mt-1">{c.desc}</p>
          </div>
        ))}
      </div>

      <div className="flex gap-16 mt-16 flex-wrap">
        {t.home.stats.map((s, i) => (
          <div key={i}>
            <div className="text-3xl font-bold text-gray-900">{s.num}</div>
            <div className="text-sm text-gray-400 uppercase tracking-widest mt-0.5">{s.label}</div>
          </div>
        ))}
      </div>
    </div>
  );

  /* â”€â”€â”€ POSTS â”€â”€â”€ */
  const Posts = () => {
    const [open, setOpen] = useState(false);
    const [form, setForm] = useState({ type:"skill", title:"", desc:"", region: profile?.region || "gunma" });
    const filtered = filterRegion === "all" ? posts : posts.filter(p => p.region === filterRegion);

    const submit = () => {
      if (!form.title) return;
      setPosts([{ id: Date.now(), type: form.type, author: profile?.name || "ã‚ãªãŸ", region: form.region,
        title:{ ja: form.title, en: form.title }, desc:{ ja: form.desc, en: form.desc }, likes:0 }, ...posts]);
      setForm({ type:"skill", title:"", desc:"", region: profile?.region || "gunma" });
      setOpen(false);
    };

    return (
      <div className="max-w-3xl mx-auto py-8 px-4">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-3xl font-bold text-gray-900">{t.posts.heading}</h2>
          <button onClick={() => setOpen(!open)} className="inline-flex items-center gap-1.5 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors">
            <Plus size={16} /> {t.posts.newPost}
          </button>
        </div>
        <FilterBar />

        {open && (
          <div className="bg-white border border-gray-200 rounded-xl p-5 mb-6">
            <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{t.posts.form.region}</label>
            <select value={form.region} onChange={e => setForm({...form, region: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-gray-900">
              {regions.map(r => <option key={r.key} value={r.key}>{r[lang]}</option>)}
            </select>
            <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{t.posts.form.type}</label>
            <select value={form.type} onChange={e => setForm({...form, type: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-gray-900">
              <option value="skill">{t.posts.form.offerSkill}</option>
              <option value="help">{t.posts.form.needHelp}</option>
            </select>
            <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{t.posts.form.title}</label>
            <input value={form.title} onChange={e => setForm({...form, title: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-gray-900" />
            <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{t.posts.form.desc}</label>
            <textarea value={form.desc} onChange={e => setForm({...form, desc: e.target.value})} rows={3} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-4 focus:outline-none focus:ring-2 focus:ring-gray-900" />
            <button onClick={submit} className="bg-gray-900 text-white px-5 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors">{t.posts.form.submit}</button>
          </div>
        )}

        <div className="space-y-3">
          {filtered.map(p => (
            <div key={p.id} className="bg-white border border-gray-200 rounded-xl p-5 hover:border-gray-300 transition-colors">
              <div className="flex items-center gap-3 mb-3 flex-wrap">
                <div className="w-9 h-9 rounded-full bg-gray-900 text-white flex items-center justify-center text-sm font-semibold">{p.author[0]}</div>
                <span className="font-medium text-gray-900 text-sm">{p.author}</span>
                <span className={`text-xs font-semibold px-2.5 py-0.5 rounded-full ${p.type==="skill" ? "bg-sky-100 text-sky-700" : "bg-amber-100 text-amber-700"}`}>
                  {p.type==="skill" ? t.posts.skillShare : t.posts.helpNeeded}
                </span>
                <span className="ml-auto text-xs text-gray-400 flex items-center gap-1">
                  <MapPin size={12} />{regionLabel(p.region)}
                </span>
              </div>
              <h3 className="font-semibold text-gray-900 mb-1">{p.title[lang]}</h3>
              <p className="text-sm text-gray-500 leading-relaxed mb-4">{p.desc[lang]}</p>
              <div className="flex gap-2">
                <button className="inline-flex items-center gap-1.5 border border-gray-300 rounded-lg px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-50 transition-colors">
                  <Heart size={16} /> {p.likes}
                </button>
                <button onClick={() => alert(t.msgSent)} className="inline-flex items-center gap-1.5 bg-gray-900 text-white rounded-lg px-3 py-1.5 text-sm hover:bg-gray-700 transition-colors">
                  <MessageCircle size={16} /> {t.posts.sendMsg}
                </button>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  /* â”€â”€â”€ EVENTS â”€â”€â”€ */
  const Events = () => {
    const filtered = filterRegion === "all" ? initialEvents : initialEvents.filter(e => e.region === filterRegion);
    return (
      <div className="max-w-3xl mx-auto py-8 px-4">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-3xl font-bold text-gray-900">{t.events.heading}</h2>
          <button className="inline-flex items-center gap-1.5 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors">
            <Plus size={16} /> {t.events.createEvent}
          </button>
        </div>
        <FilterBar />
        <div className="space-y-3">
          {filtered.map(ev => (
            <div key={ev.id} className="bg-white border border-gray-200 rounded-xl p-5 hover:border-gray-300 transition-colors">
              <div className="flex items-start justify-between gap-4">
                <div>
                  <div className="flex items-center gap-2 mb-2">
                    <h3 className="font-semibold text-gray-900 text-lg">{ev.title[lang]}</h3>
                    <span className="text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full">{regionLabel(ev.region)}</span>
                  </div>
                  <div className="flex flex-wrap gap-4 text-sm text-gray-500 mb-2">
                    <span className="flex items-center gap-1.5"><Calendar size={16} />{ev.date}</span>
                    <span className="flex items-center gap-1.5"><MapPin size={16} />{ev.location[lang]}</span>
                    <span className="flex items-center gap-1.5"><Users size={16} />{ev.participants} {t.events.participants}</span>
                  </div>
                  <p className="text-sm text-gray-500">{ev.desc[lang]}</p>
                </div>
                <button className="flex-shrink-0 bg-gray-900 text-white px-5 py-2 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors">{t.events.join}</button>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  /* â”€â”€â”€ PROFILE â”€â”€â”€ */
  const Profile = () => {
    const [form, setForm] = useState(profile || { type:"", name:"", interests:"", teach:"", help:"", region:"gunma" });
    const types = [{ key:"local", icon:"ğŸ " }, { key:"foreigner", icon:"ğŸŒ" }, { key:"migrant", icon:"âœˆï¸" }];

    return (
      <div className="max-w-xl mx-auto py-8 px-4">
        <h2 className="text-3xl font-bold text-gray-900 mb-8">{t.profile.heading}</h2>
        <div className="bg-white border border-gray-200 rounded-xl p-6">
          <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-3">{t.profile.yourType}</label>
          <div className="grid grid-cols-3 gap-3 mb-6">
            {types.map(tp => (
              <button key={tp.key} onClick={() => setForm({...form, type: tp.key})}
                className={`border-2 rounded-xl p-4 text-center transition-colors ${form.type===tp.key ? "border-gray-900 bg-gray-50" : "border-gray-200 hover:border-gray-400"}`}
              >
                <div className="text-2xl">{tp.icon}</div>
                <div className="text-sm font-medium mt-1 text-gray-700">{t.profile[tp.key]}</div>
              </button>
            ))}
          </div>

          <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{t.profile.region}</label>
          <select value={form.region} onChange={e => setForm({...form, region: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-5 focus:outline-none focus:ring-2 focus:ring-gray-900">
            {regions.map(r => <option key={r.key} value={r.key}>{r[lang]}</option>)}
          </select>

          {[
            { key:"name",      label: t.profile.name,      placeholder:"",                     rows:0 },
            { key:"interests", label: t.profile.interests,  placeholder: t.profile.placeholder, rows:0 },
            { key:"teach",     label: t.profile.canTeach,   placeholder:"",                     rows:2 },
            { key:"help",      label: t.profile.needHelp,   placeholder:"",                     rows:2 },
          ].map(f => (
            <div key={f.key} className="mb-4">
              <label className="block text-xs font-semibold text-gray-400 uppercase tracking-wide mb-1">{f.label}</label>
              {f.rows > 0
                ? <textarea value={form[f.key]} onChange={e => setForm({...form,[f.key]:e.target.value})} rows={f.rows} placeholder={f.placeholder} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-900" />
                : <input    value={form[f.key]} onChange={e => setForm({...form,[f.key]:e.target.value})}             placeholder={f.placeholder} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-900" />
              }
            </div>
          ))}

          <button onClick={() => { setProfile(form); setFilterRegion(form.region); alert(t.saved); setView("posts"); }}
            className="w-full mt-2 bg-gray-900 text-white py-2.5 rounded-lg font-medium hover:bg-gray-700 transition-colors"
          >{t.profile.save}</button>
        </div>
      </div>
    );
  };

  /* â”€â”€â”€ LAYOUT â”€â”€â”€ */
  return (
    <div className="min-h-screen bg-gray-50 flex flex-col">
      <header className="bg-white border-b border-gray-200">
        <div className="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
          <div className="flex items-center gap-2 cursor-pointer" onClick={() => setView("home")}>
            <span className="text-2xl">ğŸŒ</span>
            <div>
              <div className="font-bold text-gray-900 leading-none">{t.appName}</div>
              <div className="text-xs text-gray-400">{t.tagline}</div>
            </div>
          </div>
          <button onClick={() => setLang(lang==="ja"?"en":"ja")} className="border border-gray-300 rounded-lg px-3 py-1.5 text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors">
            {lang==="ja" ? "EN" : "JP"}
          </button>
        </div>
      </header>

      <nav className="bg-white border-b border-gray-200 sticky top-0 z-10">
        <div className="max-w-5xl mx-auto px-4 flex gap-1">
          {["home","posts","events","profile"].map(k => (
            <button key={k} onClick={() => setView(k)}
              className={`relative px-4 py-3 text-sm font-medium transition-colors ${view===k ? "text-gray-900" : "text-gray-400 hover:text-gray-600"}`}
            >
              {t.nav[k]}
              {view===k && <span className="absolute inset-x-0 bottom-0 h-0.5 bg-gray-900" />}
            </button>
          ))}
        </div>
      </nav>

      <main className="flex-1">
        {view==="home"    && <Home />}
        {view==="posts"   && <Posts />}
        {view==="events"  && <Events />}
        {view==="profile" && <Profile />}
      </main>

      <footer className="bg-gray-900 text-gray-400 text-center text-xs py-5 mt-auto">
        {lang==="ja"
          ? "Â© 2026 ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒãƒ‡ã‚£ãƒ¼ â€” ç¾¤é¦¬çœŒãƒ»æ ƒæœ¨çœŒãƒ»é•·é‡çœŒã®å¤šæ–‡åŒ–å…±ç”Ÿã‚’æ”¯æ´ã—ã¾ã™"
          : "Â© 2026 Culture Buddy â€” Supporting multicultural community in Gunma, Tochigi & Nagano"}
      </footer>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
